---
title: "$D_4$ Lattice"
---

## Overview

The checkerboard lattice $D_4$ is the canonical 4D lattice: it gives the **densest lattice packing** in four dimensions, has a highly symmetric Voronoi cell (the **regular 24–cell**), and enjoys clean algebraic descriptions that make it a model example for coding/quantization. We build $D_4$ from a basis, describe its Voronoi region and quantizer, work out exact packing/covering/kissing numbers, and show how **nested pairs** ($2D_4\subset D_4$) provide finite **coset** labels and a useful modulo map. We also touch on the dual $D_4^*$ and quick comparisons to $\mathbb{Z}^4$.

## Defining $D_4$

### Set and basis descriptions
The set description is
$$
D_4 \;=\;\big\{ x\in\mathbb{Z}^4 : x_1+x_2+x_3+x_4 \equiv 0 \pmod{2} \big\}.
$$
A convenient basis (columns of $B$) is
$$
B\;=\;\begin{bmatrix}
1 & 0 & 0 & 0\\
-1& 1 & 0 & 0\\
0 & -1& 1 & 1\\
0 & 0 & -1& 1
\end{bmatrix},
\qquad D_4 = B\,\mathbb{Z}^4.
$$
The Gram matrix is $G=B^\top B$ and the **covolume** (fundamental 4–volume) is
$$
\det(D_4) \,=\, |\det B| \,=\, 2,\qquad \det(G)=4\;\;\text{(discriminant)}.
$$

### Minimal vectors and symmetry

The **minimum distance** is $d(D_4)=\sqrt{2}$. The $24$ minimal vectors are the permutations of $(\pm 1,\pm 1,0,0)$ with all sign choices (subject to the even–sum constraint). The **kissing number** is therefore
$$
\tau(D_4)=24.
$$

## Voronoi Cell and Quantization

The Voronoi cell of $D_4$ is the **regular 24–cell** centered at the origin. An explicit half–space description (from the $24$ minimal vectors) is
$$
\mathcal{V}_{D_4}\;=\;\big\{ x\in\mathbb{R}^4 : \; |x_i\pm x_j|\le 1 \;\text{for all}\; 1\le i<j\le 4 \big\}.
$$
The **nearest–neighbor quantizer** and **modulo–lattice** map are
$$
Q_{D_4}(x) := \operatorname*{arg\,min}_{\lambda\in D_4}\|x-\lambda\|,\qquad
x\bmod D_4 := x - Q_{D_4}(x)\in\mathcal{V}_{D_4}.
$$
(On Voronoi boundaries, fix any deterministic tie–break.)

**Radii of the 24–cell (with this normalization).** The distance from the origin to any Voronoi facet equals $d/2=\tfrac{\sqrt{2}}{2}$ (the **inradius**). The farthest points in $\mathcal{V}_{D_4}$ have norm $1$ (e.g., $(\tfrac12,\tfrac12,\tfrac12,\tfrac12)$), so the **circumradius**—and hence the **covering radius**—is
$$
\rho(D_4)=1.
$$

## Packing and Covering in $\mathbb{R}^4$

The 4–ball volume is $\mathrm{vol}\,\mathcal{B}_4(0,R)=\tfrac{\pi^2}{2}\,R^4$. With $d(D_4)=\sqrt{2}$ the **packing radius** is $r_{\mathrm{pack}}=\tfrac{1}{\sqrt{2}}$. Therefore
$$
\Delta(D_4)\;=\;\frac{\mathrm{vol}\,\mathcal{B}_4(0,\,r_{\mathrm{pack}})}{\det(D_4)}
\;=\;\frac{\frac{\pi^2}{2}\,(\tfrac{1}{\sqrt{2}})^4}{2}
\;=\;\frac{\pi^2}{16}\;\approx\;0.61685.
$$
For covering,
$$
\Theta(D_4)\;=\;\frac{\mathrm{vol}\,\mathcal{B}_4(0,\,\rho(D_4))}{\det(D_4)}
\;=\;\frac{\frac{\pi^2}{2}\cdot 1^4}{2}
\;=\;\frac{\pi^2}{4}\;\approx\;2.4674.
$$

## Nested Pairs, Cosets, and the Modulo Map

A natural coarse sublattice is the dilation $\Lambda_c=2D_4\subset D_4$. The index is
$$
[\,D_4 : 2D_4\,] = 2^4 = 16,
$$
so there are $16$ **cosets** $\lambda+2D_4$ in $D_4$. In a basis $B$, writing $\lambda=Bk$ with $k\in\mathbb{Z}^4$, the coset label is simply $k\bmod 2\in\mathbb{Z}_2^4$ (Smith normal form reduces to $D=2I_4$ here).

- **Quantization (fine):** $x\mapsto Q_{D_4}(x)\in D_4$.

- **Shaping (coarse modulo):** $x\mapsto x\bmod 2D_4\in\mathcal{V}_{2D_4}$ is a bounded representative; the coset index carries $\log_2[ D_4:2D_4 ]=4$ bits per symbol.

## Dual Lattice and Checks

The **dual lattice** is
$$
D_4^* := \{ y\in\mathbb{R}^4 : \langle y,x\rangle\in\mathbb{Z}\ \forall x\in D_4\},
\qquad \det(D_4)\,\det(D_4^*) = 1,
$$
so $\det(D_4^*)=\tfrac12$. One may describe $D_4^*$ as integer or half–integer vectors with parity constraints; more importantly, it provides the frequency set for Fourier analysis on the torus $\mathbb{R}^4/D_4$ (Poisson summation, theta series).

**Sanity checks (with this normalization).**
- $d(D_4)=\sqrt{2}$, $r_{\mathrm{pack}}=1/\sqrt{2}$, $\rho(D_4)=1$.

- $\det(D_4)=2$, $\det(D_4^*)=1/2$.

- $\tau(D_4)=24$, $\Delta(D_4)=\pi^2/16$, $\Theta(D_4)=\pi^2/4$.

## Practical Notes (Decoding/Quantization)

- **Babai rounding:** Compute coefficients $c=B^{-1}x$ and round to $\hat k=\mathrm{round}(c)$, giving $\hat\lambda=B\hat k$; this is an efficient approximation to $Q_{D_4}(x)$ that is exact off a set of small measure.

- **Modulo implementation:** To compute $x\bmod D_4$ without explicit nearest–neighbor search, reduce in the $B$–basis and project back, or use the half–space form $|x_i\pm x_j|\le 1$ to pull $x$ into $\mathcal{V}_{D_4}$ by successive reflections.

- **Shaping gain:** Replacing $\mathbb{Z}^4$ by $D_4$ as a shaping lattice reduces second moment and improves high–rate quantizer efficiency.

## Comparisons and Context

- **Versus $\mathbb{Z}^4$:** $\Delta(\mathbb{Z}^4)=\pi^2/32$ and $\Theta(\mathbb{Z}^4)=\pi^2/2$; $D_4$ is both **denser** and **covers better**.

- **Symmetry:** The Voronoi 24–cell is self–dual; this symmetry underlies clean formulas and uniform neighbor structure.

- **Coding:** The nested pair $2D_4\subset D_4$ yields $16$ cosets (4 bits/symbol); more structured pairs arise via Construction A from binary codes.

## Exercises (Paper–and–pencil)

1. **Facet inequalities.** Starting from the minimal vectors $\pm e_i\pm e_j$, derive $|x_i\pm x_j|\le 1$ for $\mathcal{V}_{D_4}$.

2. **Radii.** Show the inradius of $\mathcal{V}_{D_4}$ equals $d/2=\sqrt{2}/2$ and that points like $(1/2,1/2,1/2,1/2)$ have norm $1$, hence $\rho(D_4)=1$.

3. **Cosets.** List all $16$ coset reps of $D_4/2D_4$ as parity patterns of $k\in\mathbb{Z}^4$ in the basis $B$.

4. **Density.** Verify $\Delta(D_4)=\pi^2/16$ using $\mathrm{vol}\,\mathcal{B}_4(0,R)=\tfrac{\pi^2}{2}R^4$ and $r_{\mathrm{pack}}=1/\sqrt{2}$.

## Quick Reference (Numbers for $D_4$)

- Basis $B$ above; $\det(D_4)=2$, discriminant $=\det(G)=4$.

- $d=\sqrt{2}$, $r_{\mathrm{pack}}=1/\sqrt{2}$, $\rho=1$.

- $\tau=24$, $\Delta=\pi^2/16\approx 0.61685$, $\Theta=\pi^2/4\approx 2.4674$.

- Dual: $\det(D_4^*)=1/2$; $|D_4^*/D_4|=4$ (index $4$).

